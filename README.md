# Документация к API Yatube (v1)

## О проекте:
Позволяет организовать соцсеть для ведения блогов с возможностью регистрации пользователей,
добавления записей пользователями и написания комментариев к записям. Реализована возможность
подписки на записи отдельных пользователей.
Доступно создание сообществ для классификации постов.
Управление соцсетью реализовано через **API на JSON**, также есть возможность управления через
**веб-панель администратора**.

## Как запустить проект:

Для запуска в ОС Windows вам потребуется терминал **Bash**. Скачать и установить его можно по ссылке: 
 [GitBash](https://gitforwindows.org/).
**Запуск с помощью PowerShell или других терминалов не гарантируется!**


**Также вам будет необходим интерпретатор языка Python. Рекомендуется использовать версию 3.7**

Сайт загрузки:
 [https://www.python.org/](https://www.python.org/downloads/)

***Важно! В примерах ниже в GitBash в ОС Windows для вызова интерпретатора Python необходимо
использовать команду python вместо python3. В случае, если при вызове python возникает ошибка,
следует использовать python3***

Для загрузки проекта на ваш компьютер, необходимо ввести в **GitBash** команду:

```
git clone https://github.com/arsnet77/api_final_yatube
```

Далее перейти в директорию **api_final_yatube/**:
```
cd api_final_yatube
```

Создать виртуальное окружение:

```
python -m venv venv
```

Запустить виртуальное окружение:

```
>source venv/Scripts/activate
```

Установить зависимости из файла **requirements.txt**:

```
python -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```

Выполнить миграции:

```
python manage.py migrate
```

Создать учетную запись суперпользователя (если необходимо)
```
python manage.py createsuperuser
```

Запустить проект:

```
python manage.py runserver
```



## Работа с веб-панелью администратора:

Перейдите в браузере по адресу
[http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)
Войдите в админ-панель используя учетные данные, введенные ранее после команды **createsuperuser**

## Работа с эндпоинтами API:

### Работа с публикациями:

**Чтение** доступно *всем пользователям* без исключения, **добавлять** новые 
 записи могут только *зарегистрированные пользователи*.
**Изменять** или **удалять** записи могут только *авторы* этих записей.

#### Получение публикаций

Получить список всех публикаций. При указании параметров **limit** и **offset**
 результаты будут переданы постранично.

GET: [http://127.0.0.1:8000/api/v1/posts/](http://127.0.0.1:8000/api/v1/posts/)

Ответ, статус код 200:

```JSON
[
    {
      "id": 0,
      "author": "string",
      "text": "string",
      "pub_date": "2019-08-24T14:15:22Z",
      "image": "string",
      "group": 0
    }
]
```


Параметры передаваемые в запрос:
>**limit**: количество публикаций, выводимых на одну страницу.
>
>**offset**: номер страницы с которой начинать выдачу.

GET: [http://127.0.0.1:8000//api/v1/posts/?offset=400&limit=100](http://127.0.0.1:8000/api/v1/posts/?offset=400&limit=100)

Ответ, статус код 200:

```JSON
{
  "count": 123,
  "next": "http://api.example.org/accounts/?offset=400&limit=100",
  "previous": "http://api.example.org/accounts/?offset=200&limit=100",
  "results": [
    {
      "id": 0,
      "author": "string",
      "text": "string",
      "pub_date": "2019-08-24T14:15:22Z",
      "image": "string",
      "group": 0
    }
  ]
}
```

#### Получение одной публикации по её id:


Параметр пути, передаваемый в GET запросе:
>**id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору публикации.

GET: api/v1/posts/{id}/

GET: [http://127.0.0.1:8000/api/v1/posts/0/](http://127.0.0.1:8000/api/v1/posts/0/)

Ответ, статус код 200:

```JSON
[
    {
      "id": 0,
      "author": "string",
      "text": "string",
      "pub_date": "2019-08-24T14:15:22Z",
      "image": "string",
      "group": 0
    }
]
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Создание публикации:
Добавление новой публикации в коллекцию публикаций. Анонимные запросы запрещены.


GET: api/v1/posts/

GET: [http://127.0.0.1:8000/api/v1/posts/](http://127.0.0.1:8000/api/v1/posts/)

JSON, передаваемый в запросе:
```JSON
{
"text": "string",
"image": "string",
"group": 0
}
```
>**text**: тип string, Текст публикации. Обязательное поле.
> 
>**image**: тип string, Адрес изображения, прикрепленного к публикации.
> 
>**group**: тип integer, целое положительное число. Соответствует идентификатору группы.


Ответ, статус код 201:

```JSON
{
"id": 0,
"author": "string",
"text": "string",
"pub_date": "2019-08-24T14:15:22Z",
"image": "string",
"group": 0
}
```

Ответ, статус код 400:

```JSON
{
"text": [
"Обязательное поле."
]
}
```

Ответ, статус код 401:

```JSON
{
"detail": "Учетные данные не были предоставлены."
}
```


#### Обновление публикации:
Обновление публикации по id. Обновить публикацию может только автор публикации.
Анонимные запросы запрещены.

PUT: api/v1/posts/{id}/

PUT: [http://127.0.0.1:8000/api/v1/posts/0/](http://127.0.0.1:8000/api/v1/posts/0/)

JSON, передаваемый в запросе:
```JSON
{
"text": "string",
"image": "string",
"group": 0
}
```
>**text**: тип string, Текст публикации. Обязательное поле.
> 
>**image**: тип string, Адрес изображения, прикрепленного к публикации.
> 
>**group**: тип integer, целое положительное число. Соответствует идентификатору группы.


Ответ, статус код 200:

```JSON
{
"id": 0,
"author": "string",
"text": "string",
"pub_date": "2019-08-24T14:15:22Z",
"image": "string",
"group": 0
}
```

Ответ, статус код 400:

```JSON
{
"text": [
"Обязательное поле."
]
}
```

Ответ, статус код 401:

```JSON
{
"detail": "Учетные данные не были предоставлены."
}
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Частичное обновление публикации:
Частичное обновление публикации по id. Обновить публикацию может только автор публикации.
Анонимные запросы запрещены.

PATCH: api/v1/posts/{id}/

PATCH: [http://127.0.0.1:8000/api/v1/posts/0/](http://127.0.0.1:8000/api/v1/posts/0/)

JSON, передаваемый в запросе:
```JSON
{
"text": "string",
"image": "string",
"group": 0
}
```
>**text**: тип string, Текст публикации. Обязательное поле.
> 
>**image**: тип string, Адрес изображения, прикрепленного к публикации.
> 
>**group**: тип integer, целое положительное число. Соответствует идентификатору группы.


Ответ, статус код 200:

```JSON
{
"id": 0,
"author": "string",
"text": "string",
"pub_date": "2019-08-24T14:15:22Z",
"image": "string",
"group": 0
}
```


Ответ, статус код 401:

```JSON
{
"detail": "Учетные данные не были предоставлены."
}
```

Ответ, статус код 403:

```JSON
{
"detail": "У вас недостаточно прав для выполнения данного действия."
}
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Удаление публикации:
Удаление публикации по id. Удалить публикацию может только автор публикации.
Анонимные запросы запрещены.

DELETE: api/v1/posts/{id}/

DELETE: [http://127.0.0.1:8000/api/v1/posts/0/](http://127.0.0.1:8000/api/v1/posts/0/)


Ответ, статус код 204: Удачное выполнение запроса, запись удалена.



Ответ, статус код 401:

```JSON
{
"detail": "Учетные данные не были предоставлены."
}
```

Ответ, статус код 403:

```JSON
{
"detail": "У вас недостаточно прав для выполнения данного действия."
}
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Получение комментариев:
Получение всех комментариев к публикации.

GET: api/v1/posts/{id}/comments/

GET: [http://127.0.0.1:8000/api/v1/posts/{post_id}/comments/](http://127.0.0.1:8000/api/v1/posts/{post_id}/comments/)


Ответ, статус код 200:

```JSON
[
  {
    "id": 0,
    "author": "string",
    "text": "string",
    "created": "2019-08-24T14:15:22Z",
    "post": 0
  }
]
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Добавление комментария:
Добавление нового комментария к публикации. Анонимные запросы запрещены.
Анонимные запросы запрещены.


GET: api/v1/posts/

GET: [http://127.0.0.1:8000/api/v1/posts/0/comments/](http://127.0.0.1:8000/api/v1/posts/0/comments/)

JSON, передаваемый в запросе:
```JSON
{
  "text": "string"
}
```
>**text**: тип string, Текст публикации. Обязательное поле.


Ответ, статус код 201:

```JSON
{
"id": 0,
"author": "string",
"text": "string",
"created": "2019-08-24T14:15:22Z",
"post": 0
}
```

Ответ, статус код 400:

```JSON
{
"text": [
"Обязательное поле."
]
}
```

Ответ, статус код 401:

```JSON
{
"detail": "Учетные данные не были предоставлены."
}
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Получение комментария по его id:
Получение комментария к публикации по id.


Параметр пути, передаваемый в GET запросе:
>**post_id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору публикации.
>**id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору комментария.

GET: api/v1/posts/{post_id}/comments/{id}/

GET: [http://127.0.0.1:8000/api/v1/posts/0/comments/0/](http://127.0.0.1:8000/api/v1/posts/0/comments/0/)

Ответ, статус код 200:

```JSON
{
  "id": 0,
  "author": "string",
  "text": "string",
  "created": "2019-08-24T14:15:22Z",
  "post": 0
}
```

Ответ, статус код 404:

```JSON
{
  "detail": "Страница не найдена."
}
```

#### Обновление комментария:
Обновление комментария к публикации по id.
Обновить комментарий может только автор комментария. Анонимные запросы запрещены.


Параметр пути, передаваемый в GET запросе:
>**post_id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору публикации.
> **id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору комментария.

PUT: http://127.0.0.1:8000/api/v1/posts/{post_id}/comments/{id}/

PUT: [http://127.0.0.1:8000/api/v1/posts/0/comments/0/](http://127.0.0.1:8000/api/v1/posts/0/comments/0/)

JSON, передаваемый в запросе:
```JSON
{
"text": "string"
}
```

Ответ, статус код 200:

```JSON
[
    {
      "id": 0,
      "author": "string",
      "text": "string",
      "pub_date": "2019-08-24T14:15:22Z",
      "image": "string",
      "group": 0
    }
]
```

Другие возможные коды ответов, аналогично примерам выше:
>400, 401, 403, 404.


#### Частичное обновление комментария:
Частичное обновление комментария к публикации по id.
Обновить комментарий может только автор комментария. Анонимные запросы запрещены.


Параметр пути, передаваемый в GET запросе:
>**post_id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору публикации.
> **id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору комментария.

PATCH: http://127.0.0.1:8000/api/v1/posts/{post_id}/comments/{id}/

PATCH: [http://127.0.0.1:8000/api/v1/posts/0/comments/0/](http://127.0.0.1:8000/api/v1/posts/0/comments/0/)

JSON, передаваемый в запросе:
```JSON
{
"text": "string"
}
```

Ответ, статус код 200:

```JSON
[
    {
      "id": 0,
      "author": "string",
      "text": "string",
      "pub_date": "2019-08-24T14:15:22Z",
      "image": "string",
      "group": 0
    }
]
```

Другие возможные коды ответов, аналогично примерам выше:
>401, 403, 404.


#### Удаление комментария:
Удаление комментария к публикации по id.  Удалить комментарий может только автор комментария.
Анонимные запросы запрещены.

DELETE: api/v1/posts/{id}/comments/{id}/

DELETE: [http://127.0.0.1:8000/api/v1/posts/0/comments/0/](http://127.0.0.1:8000/api/v1/posts/0/comments/0/)


Ответ, статус код 204: Удачное выполнение запроса, комментарий удалён.


Другие возможные коды ответов, аналогично примерам выше:
>401, 403, 404.

#### Получение списка сообществ.

Получение списка доступных сообществ.

GET: api/v1/groups/

GET: [http://127.0.0.1:8000/api/v1/groups/](http://127.0.0.1:8000/api/v1/groups/)

Ответ, статус код 200:

```JSON
[
  {
    "id": 0,
    "title": "string",
    "slug": "string",
    "description": "string"
  }
]
```

#### Информация о сообществе по его id:
Получение информации о сообществе по id.


Параметр пути, передаваемый в GET запросе:
>**id**: тип integer, целое положительное число. Соответствует уникальному 
> идентификатору сообщества.

GET: api/v1/groups/{id}/

GET: [http://127.0.0.1:8000/api/v1/groups/0/](http://127.0.0.1:8000/api/v1/groups/0/)

Ответ, статус код 200:

```JSON
{
  "id": 0,
  "title": "string",
  "slug": "string",
  "description": "string"
}
```


Другие возможные коды ответов, аналогично примерам выше:
>404.


#### Подписки:
Возвращает все подписки пользователя, сделавшего запрос. Анонимные запросы запрещены.


GET: api/v1/follow/

GET: [http://127.0.0.1:8000/api/v1/follow/](http://127.0.0.1:8000/api/v1/follow/)

Ответ, статус код 200:



```JSON
[
  {
    "user": "string",
    "following": "string"
  }
]
```
Параметры ответа
>**user**: тип string, текст. Имя пользователя (кто подписан).
> 
>**following**: тип string, текст. Пользователь, на которого подписаны.

Другие возможные коды ответов, аналогично примерам выше:
>401.

#### Создание подписки:
Подписка пользователя от имени которого сделан запрос на пользователя переданного в
теле запроса. Анонимные запросы запрещены.


POST: api/v1/follow/

POST: [http://127.0.0.1:8000/api/v1/follow/](http://127.0.0.1:8000/api/v1/follow/)

JSON, передаваемый в запросе:
```JSON
{
"following": "string"
}
```
>**following**: тип string, текст. Пользователь, на которого нужно подписаться.


Ответ, статус код 201:

```JSON
{
"user": "string",
"following": "string"
}
```

Другие возможные коды ответов, аналогично примерам выше:
>400, 401.


#### Получить JWT-токен:
Получение JWT-токена.


POST: api/v1/jwt/create/

POST: [http://127.0.0.1:8000/api/v1/jwt/create/](http://127.0.0.1:8000/api/v1/jwt/create/)

JSON, передаваемый в запросе:
```JSON
{
  "username": "string",
  "password": "string"
}
```
>**username**: тип string, текст. Имя учётной записи пользователя.
> 
>**password**: тип string, текст. Пароль учётной записи.


Ответ, статус код 200:

```JSON
{
  "refresh": "string",
  "access": "string"
}
```

Другие возможные коды ответов, аналогично примерам выше:
>400, 401.


#### Обновить JWT-токен:
Обновление JWT-токена.


POST: api/v1/jwt/refresh/

POST: [http://127.0.0.1:8000/api/v1/jwt/refresh/](http://127.0.0.1:8000/api/v1/jwt/refresh/)

JSON, передаваемый в запросе:
```JSON
{
  "refresh": "string"
}
```


Ответ, статус код 200:

```JSON
{
  "access": "string"
}
```

Другие возможные коды ответов, аналогично примерам выше:
>400, 401.


#### Проверить JWT-токен:
Проверка JWT-токена.


POST: api/v1/jwt/verify/

POST: [http://127.0.0.1:8000/api/v1/jwt/verify/](http://127.0.0.1:8000/api/v1/jwt/verify/)

JSON, передаваемый в запросе:
```JSON
{
  "token": "string"
}
```


Ответ, статус код 200 - Удачное выполнение запроса.


Ответ, статус код 400:

```JSON
{
  "token": [
    "Обязательное поле."
  ]
}
```

Ответ, статус код 401:

```JSON
{
  "detail": "Token is invalid or expired",
  "code": "token_not_valid"
}
```